
# 취약점 설명

CVE-2019-5736취약점은
도커 컨테이너 CLI 툴인 runc에서 발생한다.


컨테이너 내에서 실행되는 프로세스들은 호스트 시스템의 파일 디스크립터를 공유하여 사용한다. 

그러나 runC는 호스트 시스템에서 파일 디스크립터를 다시 열고 그것을 컨테이너 내의 프로세스에 전달하는 기능을 가지고 있다. 

이 과정에서 파일 디스크립터를 전달 받은 프로세스는 그 파일 디스크립터가 소유하는 파일에 대한 제어 권한을 가지게 되는데, 

이때 runC가 제공하는 파일 디스크립터 전달 방식의 버그로 인해, 컨테이너 내부의 악성 코드가 호스트 시스템의 파일 디스크립터를 이용하여 

호스트 시스템에서 원하는 동작을 수행할 수 있게 된다  

   
  
</br>
</br>
</br>
  
# 취약점 구현

## 구현 환경 
### 희생자: Ubuntu 18.04, Docker-ce 18.06.1~ce~3-0~ubuntu
### 공격자: Ubuntu 16.04


희생자 PC에 Docker을 설치한다.

설치 과정은 Docker 공식 문서를 따르며 버전을 지정하여 설치한다.

      $sudo apt-get update
      $sudo apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common
      $curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
      $sudo add-apt-repository \
      "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
      $sudo apt-get update
      
apt-cache madison 명령어를 통해 repository에서 설치 가능한 Docker 버전을 확인할 수 있다.

      $sudo apt-cache madison docker-ce
      $sudo apt-get install docker-ce=18.06.1~ce~3-0~ubuntu

취약점 구현을 위해 Docker 버전을 18.06 버전으로 설치한다.

      $cat <<EOF | sudo tee /etc/docker/daemon.json
      {
       "exec-opts": ["native.cgroupdriver=systemd"],
        "log-driver": "json-file",
        "log-opts": {
          "max-size": "100m"
        },
        "storage-driver": "overlay2"
      }
      EOF
      
      
      $sudo systemctl daemon-reload
      $sudo systemctl restart docker.service
